# 郵便物自動仕分け・リネームシステム 操作マニュアル

## 1. システム概要
本システムは、スキャンされた大量のPDFファイルを自動で解析し、顧客ごと・書類の種類ごとに分割およびリネームを行うためのデスクトップアプリケーションです。
OCR（光学文字認識）技術を用いて日付、会社名、書類名を自動抽出し、作業者の確認を経て、指定の命名規則に基づいたPDFファイルを一括生成します。

### 主な機能
- **自動分類提案**: OCR結果に基づき、封筒の切り替わりや同一書類の判定を自動で行います。
- **顧客リスト連携**: Excel形式の顧客名簿を読み込むことで、抽出された会社名の補正やサジェストが可能です。
- **柔軟な編集**: 抽出された日付、会社名、書類名、被保険者名をUI上で簡単に修正できます。
- **一括ZIP保存**: 分割・リネームされた複数のPDFを一括でZIP形式でダウンロードできます。

---

## 2. 基本的な操作フロー

### ステップ1：ファイルのアップロード
1. **スキャンPDF**: 処理したいPDFファイルをドラッグ＆ドロップまたは選択してアップロードします。
2. **顧客リスト（任意）**: 顧客名が含まれるExcelファイルをアップロードすると、会社名の入力がスムーズになります。
3. **書類名リスト（任意）**: 過去に保存した `書類名一覧.json` があれば読み込めます。
4. **処理開始**: 「処理を開始」ボタンをクリックします。

### ステップ2：書類の分類と情報修正
1ページずつプレビューを確認しながら、以下の設定を行います。

#### 分類モードの選択
- **① 顧問先切替 (1)**: 前のページまでとは別の封筒（別の顧客）として扱います。
- **② 内容切替 (2)**: 顧客は同じですが、別の物理書類としてPDFを分割します。
- **③ 同一書類 (3)**: 前のページと同じPDFファイルに結合します。

#### 抽出情報の修正
項目をダブルクリックすることで編集可能です。
- **日付**: YYMMDD形式（例: 260131）
- **会社名**: 入力欄を空にすると、アップロードした顧客リストから候補が表示されます。
- **書類名**: よく使う書類名はサジェストされます。「控」「返戻」ボタンで簡単に文字を追加できます。
- **直接指定**: 命名規則を無視して任意のファイル名にしたい場合に使用します。

### ステップ3：PDFの生成と保存
1. 全ページの確認が終わったら「PDF生成」をクリックします。
2. 生成されたファイル名の一覧が表示されます。
3. 必要に応じて個別にダウンロード、または「ZIP一括ダウンロード」で全てのファイルを保存します。

---

## 3. 便利な機能・ショートカット

### キーボードショートカット
効率化のために、分類画面では以下のキーが使用できます。
- `1` / `2` / `3`: 分類モードの切り替え
- `Enter`: 次のページへ
- `Shift + Enter`: 前のページへ
- `Space`: 不要データフラグの切り替え

### 書類名リストの管理
- 分類作業中に追加した新しい書類名は、自動的にブラウザ（ローカルストレージ）に保存されます。
- 結果画面の「追加した書類名一覧」から、リストの編集やJSON形式でのエクスポートが可能です。

---

## 4. よくある質問 (FAQ)

**Q. 会社名のプルダウンが出ない**
A. Excelファイルをアップロードし、アップロード画面で「会社名」が含まれる正しいカラム（列）が選択されているか確認してください。また、入力欄が空の状態でクリックすると全候補が表示されます。

**Q. 特定のページを保存したくない**
A. 「不要データ（リネーム情報のみ使用）」にチェックを入れてください。それらのページは「除外データ.pdf」としてまとめられ、通常の仕分けからは除外されます。
